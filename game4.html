<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¥¿ç“œåˆæˆå™¨ - Hayson Lam éŠæˆ²é¤¨</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            user-select: none;
        }
        
        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #0c2461 0%, #1a1a2e 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            padding: 20px;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
        }
        
        h1 {
            color: #4cd137;
            font-size: 2.5em;
            margin-bottom: 5px;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
        }
        
        .subtitle {
            color: #aaa;
            font-size: 1.1em;
            margin-bottom: 15px;
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            background: rgba(30, 30, 46, 0.8);
            padding: 15px 25px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .score-container, .level-container, .next-fruit-container {
            text-align: center;
        }
        
        .info-label {
            font-size: 0.9em;
            color: #aaa;
            margin-bottom: 5px;
        }
        
        .info-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #4cd137;
        }
        
        .next-fruit {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }
        
        .game-area {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .game-board {
            flex: 1;
            min-width: 300px;
            height: 600px;
            background: rgba(20, 20, 35, 0.7);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            border: 2px solid rgba(76, 209, 55, 0.3);
        }
        
        #gameCanvas {
            width: 100%;
            height: 100%;
        }
        
        .controls {
            width: 250px;
            background: rgba(30, 30, 46, 0.8);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }
        
        .controls h3 {
            color: #4cd137;
            margin-bottom: 20px;
            text-align: center;
            font-size: 1.4em;
        }
        
        .fruit-info {
            margin-bottom: 25px;
        }
        
        .fruit-list {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 10px;
        }
        
        .fruit-item {
            background: rgba(40, 40, 60, 0.8);
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            transition: transform 0.2s;
        }
        
        .fruit-item:hover {
            transform: scale(1.05);
        }
        
        .fruit-emoji {
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .fruit-name {
            font-size: 0.8em;
            color: #ddd;
        }
        
        .fruit-score {
            font-size: 0.7em;
            color: #4cd137;
            margin-top: 2px;
        }
        
        .buttons {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 25px;
        }
        
        button {
            padding: 15px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        #startBtn {
            background: linear-gradient(to right, #4cd137, #44bd32);
            color: white;
        }
        
        #startBtn:hover {
            background: linear-gradient(to right, #44bd32, #3fa62d);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(76, 209, 55, 0.4);
        }
        
        #resetBtn {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }
        
        #resetBtn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-3px);
        }
        
        .instructions {
            margin-top: 25px;
            background: rgba(30, 30, 46, 0.8);
            padding: 20px;
            border-radius: 12px;
            font-size: 0.95em;
            line-height: 1.5;
        }
        
        .instructions h3 {
            color: #4cd137;
            margin-bottom: 10px;
        }
        
        .instructions ul {
            padding-left: 20px;
            color: #ccc;
        }
        
        .instructions li {
            margin-bottom: 8px;
        }
        
        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 100;
            border-radius: 15px;
            display: none;
        }
        
        .game-over h2 {
            color: #e84118;
            font-size: 3em;
            margin-bottom: 20px;
        }
        
        .game-over p {
            font-size: 1.5em;
            margin-bottom: 30px;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            color: #777;
            font-size: 0.9em;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        @media (max-width: 768px) {
            .game-area {
                flex-direction: column;
            }
            
            .controls {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ‰ è¥¿ç“œåˆæˆå™¨</h1>
            <div class="subtitle">åˆæˆæ°´æœï¼Œç²å¾—é«˜åˆ†ï¼ç›®æ¨™æ˜¯åˆæˆå¤§è¥¿ç“œï¼</div>
        </div>
        
        <div class="game-info">
            <div class="score-container">
                <div class="info-label">åˆ†æ•¸</div>
                <div id="score" class="info-value">0</div>
            </div>
            
            <div class="level-container">
                <div class="info-label">ç­‰ç´š</div>
                <div id="level" class="info-value">1</div>
            </div>
            
            <div class="next-fruit-container">
                <div class="info-label">ä¸‹ä¸€å€‹æ°´æœ</div>
                <div id="nextFruit" class="next-fruit">ğŸ’</div>
            </div>
        </div>
        
        <div class="game-area">
            <div class="game-board">
                <canvas id="gameCanvas" width="500" height="600"></canvas>
                
                <div id="gameOver" class="game-over">
                    <h2>éŠæˆ²çµæŸï¼</h2>
                    <p>æœ€çµ‚åˆ†æ•¸: <span id="finalScore">0</span></p>
                    <button id="restartBtn" style="padding: 15px 30px; font-size: 1.2em;">å†ç©ä¸€æ¬¡</button>
                </div>
            </div>
            
            <div class="controls">
                <h3>æ°´æœåˆæˆè¡¨</h3>
                <div class="fruit-info">
                    <div class="fruit-list" id="fruitList">
                        <!-- æ°´æœè³‡è¨Šæœƒç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
                    </div>
                </div>
                
                <div class="buttons">
                    <button id="startBtn">é–‹å§‹éŠæˆ²</button>
                    <button id="resetBtn">é‡æ–°é–‹å§‹</button>
                </div>
                
                <div class="instructions">
                    <h3>éŠæˆ²èªªæ˜</h3>
                    <ul>
                        <li>é»æ“Šä¸Šæ–¹å€åŸŸè®“æ°´æœæ‰è½</li>
                        <li>ç›¸åŒçš„æ°´æœæœƒåˆæˆæ›´å¤§çš„æ°´æœ</li>
                        <li>åˆæˆé †åºï¼šğŸ’ â†’ ğŸ“ â†’ ğŸ‡ â†’ ğŸŠ â†’ ğŸ â†’ ğŸˆ â†’ ğŸ‰</li>
                        <li>ç•¶æ°´æœå †ç©åˆ°é ‚éƒ¨æ™‚éŠæˆ²çµæŸ</li>
                        <li>åˆæˆè¥¿ç“œç²å¾—æœ€é«˜åˆ†æ•¸ï¼</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="footer">
            Â© 2023 Hayson Lam éŠæˆ²é¤¨ | è¥¿ç“œåˆæˆå™¨éŠæˆ²
        </div>
    </div>

    <script>
        // éŠæˆ²è®Šæ•¸
        let canvas, ctx;
        let score = 0;
        let level = 1;
        let gameRunning = false;
        let gameOver = false;
        let fruits = [];
        let nextFruitType = 0;
        let dropFruit = null;
        let dropX = 250;
        const gravity = 0.5;
        const friction = 0.99;
        const fruitTypes = [
            { emoji: "ğŸ’", name: "æ«»æ¡ƒ", radius: 20, color: "#e84118", score: 1 },
            { emoji: "ğŸ“", name: "è‰è“", radius: 25, color: "#ff3838", score: 2 },
            { emoji: "ğŸ‡", name: "è‘¡è„", radius: 30, color: "#8c7ae6", score: 5 },
            { emoji: "ğŸŠ", name: "æ©™å­", radius: 35, color: "#ff9f1a", score: 10 },
            { emoji: "ğŸ", name: "è è˜¿", radius: 40, color: "#fbc531", score: 20 },
            { emoji: "ğŸˆ", name: "èœœç“œ", radius: 45, color: "#4cd137", score: 40 },
            { emoji: "ğŸ‰", name: "è¥¿ç“œ", radius: 50, color: "#009432", score: 100 }
        ];
        
        // åˆå§‹åŒ–éŠæˆ²
        function initGame() {
            canvas = document.getElementById('gameCanvas');
            ctx = canvas.getContext('2d');
            
            // è¨­ç½®ç•«å¸ƒå¤§å°
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            // åˆå§‹åŒ–æ°´æœ
            fruits = [];
            score = 0;
            level = 1;
            gameOver = false;
            gameRunning = false;
            nextFruitType = Math.floor(Math.random() * 3); // åˆå§‹æ°´æœè¼ƒå°
            
            // ç”Ÿæˆæ°´æœåˆæˆè¡¨
            generateFruitTable();
            
            // æ›´æ–°é¡¯ç¤º
            updateDisplay();
            
            // ç¹ªè£½åˆå§‹ç•«é¢
            draw();
            
            // äº‹ä»¶ç›£è½
            canvas.addEventListener('mousemove', moveDropFruit);
            canvas.addEventListener('click', dropCurrentFruit);
            document.getElementById('startBtn').addEventListener('click', startGame);
            document.getElementById('resetBtn').addEventListener('click', resetGame);
            document.getElementById('restartBtn').addEventListener('click', resetGame);
            
            // åˆå§‹æ°´æœ
            createDropFruit();
        }
        
        // ç”Ÿæˆæ°´æœåˆæˆè¡¨
        function generateFruitTable() {
            const fruitList = document.getElementById('fruitList');
            fruitList.innerHTML = '';
            
            fruitTypes.forEach((fruit, index) => {
                const fruitItem = document.createElement('div');
                fruitItem.className = 'fruit-item';
                
                fruitItem.innerHTML = `
                    <div class="fruit-emoji">${fruit.emoji}</div>
                    <div class="fruit-name">${fruit.name}</div>
                    <div class="fruit-score">${fruit.score}åˆ†</div>
                `;
                
                fruitList.appendChild(fruitItem);
            });
        }
        
        // å‰µå»ºä¸‹ä¸€å€‹æ‰è½çš„æ°´æœ
        function createDropFruit() {
            nextFruitType = Math.floor(Math.random() * Math.min(3 + level, 7));
            dropFruit = {
                type: nextFruitType,
                x: dropX,
                y: 50,
                radius: fruitTypes[nextFruitType].radius,
                color: fruitTypes[nextFruitType].color,
                emoji: fruitTypes[nextFruitType].emoji,
                dx: 0,
                dy: 0
            };
            
            // æ›´æ–°ä¸‹ä¸€å€‹æ°´æœé¡¯ç¤º
            document.getElementById('nextFruit').textContent = fruitTypes[nextFruitType].emoji;
        }
        
        // ç§»å‹•æ‰è½çš„æ°´æœï¼ˆè·Ÿéš¨æ»‘é¼ ï¼‰
        function moveDropFruit(e) {
            if (!gameRunning || gameOver || !dropFruit) return;
            
            const rect = canvas.getBoundingClientRect();
            dropX = e.clientX - rect.left;
            dropX = Math.max(dropFruit.radius, Math.min(canvas.width - dropFruit.radius, dropX));
            dropFruit.x = dropX;
        }
        
        // æ‰è½ç•¶å‰æ°´æœ
        function dropCurrentFruit() {
            if (!gameRunning || gameOver || !dropFruit) return;
            
            dropFruit.dy = 2;
            fruits.push(dropFruit);
            dropFruit = null;
            
            // å‰µå»ºæ–°çš„æ‰è½æ°´æœ
            setTimeout(createDropFruit, 500);
        }
        
        // é–‹å§‹éŠæˆ²
        function startGame() {
            if (gameRunning) return;
            
            gameRunning = true;
            document.getElementById('startBtn').textContent = "éŠæˆ²é€²è¡Œä¸­";
            document.getElementById('startBtn').disabled = true;
            
            // é–‹å§‹éŠæˆ²å¾ªç’°
            gameLoop();
        }
        
        // é‡ç½®éŠæˆ²
        function resetGame() {
            fruits = [];
            score = 0;
            level = 1;
            gameOver = false;
            gameRunning = false;
            
            document.getElementById('startBtn').textContent = "é–‹å§‹éŠæˆ²";
            document.getElementById('startBtn').disabled = false;
            document.getElementById('gameOver').style.display = "none";
            
            createDropFruit();
            updateDisplay();
            draw();
        }
        
        // éŠæˆ²å¾ªç’°
        function gameLoop() {
            if (!gameRunning || gameOver) return;
            
            update();
            draw();
            
            requestAnimationFrame(gameLoop);
        }
        
        // æ›´æ–°éŠæˆ²ç‹€æ…‹
        function update() {
            // æ›´æ–°æ‰€æœ‰æ°´æœä½ç½®
            for (let i = 0; i < fruits.length; i++) {
                let fruit = fruits[i];
                
                // æ‡‰ç”¨é‡åŠ›
                fruit.dy += gravity;
                fruit.dy *= friction;
                fruit.y += fruit.dy;
                
                // é‚Šç•Œæª¢æŸ¥
                if (fruit.x - fruit.radius < 0) {
                    fruit.x = fruit.radius;
                    fruit.dx *= -0.8;
                }
                if (fruit.x + fruit.radius > canvas.width) {
                    fruit.x = canvas.width - fruit.radius;
                    fruit.dx *= -0.8;
                }
                
                // åº•éƒ¨æª¢æŸ¥
                if (fruit.y + fruit.radius > canvas.height) {
                    fruit.y = canvas.height - fruit.radius;
                    fruit.dy *= -0.7;
                    
                    // é˜²æ­¢ç„¡é™å½ˆè·³
                    if (Math.abs(fruit.dy) < 1) {
                        fruit.dy = 0;
                    }
                }
                
                // æ°´æœç¢°æ’æª¢æ¸¬
                for (let j = i + 1; j < fruits.length; j++) {
                    let otherFruit = fruits[j];
                    let dx = fruit.x - otherFruit.x;
                    let dy = fruit.y - otherFruit.y;
                    let distance = Math.sqrt(dx * dx + dy * dy);
                    
                    if (distance < fruit.radius + otherFruit.radius) {
                        // ç¢°æ’åæ‡‰
                        let angle = Math.atan2(dy, dx);
                        let targetX = fruit.x + Math.cos(angle) * (fruit.radius + otherFruit.radius);
                        let targetY = fruit.y + Math.sin(angle) * (fruit.radius + otherFruit.radius);
                        
                        let ax = (targetX - otherFruit.x) * 0.05;
                        let ay = (targetY - otherFruit.y) * 0.05;
                        
                        fruit.dx -= ax;
                        fruit.dy -= ay;
                        otherFruit.dx += ax;
                        otherFruit.dy += ay;
                        
                        // å¦‚æœæ°´æœé¡å‹ç›¸åŒï¼Œå‰‡åˆæˆ
                        if (fruit.type === otherFruit.type && fruit.type < fruitTypes.length - 1) {
                            // æª¢æŸ¥æ˜¯å¦å·²ç¶“åœ¨åˆæˆéç¨‹ä¸­
                            if (!fruit.merging && !otherFruit.merging) {
                                fruit.merging = true;
                                otherFruit.merging = true;
                                
                                // è¨ˆç®—æ–°æ°´æœä½ç½®
                                let newX = (fruit.x + otherFruit.x) / 2;
                                let newY = (fruit.y + otherFruit.y) / 2;
                                
                                // ç§»é™¤èˆŠæ°´æœ
                                fruits.splice(j, 1);
                                fruits.splice(i, 1);
                                
                                // å‰µå»ºæ–°æ°´æœ
                                let newFruitType = fruit.type + 1;
                                let newFruit = {
                                    type: newFruitType,
                                    x: newX,
                                    y: newY,
                                    radius: fruitTypes[newFruitType].radius,
                                    color: fruitTypes[newFruitType].color,
                                    emoji: fruitTypes[newFruitType].emoji,
                                    dx: (fruit.dx + otherFruit.dx) / 2,
                                    dy: (fruit.dy + otherFruit.dy) / 2
                                };
                                
                                fruits.push(newFruit);
                                
                                // å¢åŠ åˆ†æ•¸
                                score += fruitTypes[newFruitType].score;
                                
                                // æ›´æ–°ç­‰ç´š
                                level = Math.floor(score / 100) + 1;
                                
                                updateDisplay();
                                
                                // è·³å‡ºå¾ªç’°ï¼Œå› ç‚ºæ•¸çµ„å·²ç¶“æ”¹è®Š
                                break;
                            }
                        }
                    }
                }
            }
            
            // ç§»é™¤æ¨™è¨˜ç‚ºåˆä½µçš„æ°´æœæ¨™è¨˜
            for (let i = fruits.length - 1; i >= 0; i--) {
                if (fruits[i].merging) {
                    fruits[i].merging = false;
                }
            }
            
            // æª¢æŸ¥éŠæˆ²çµæŸï¼ˆæ°´æœå †ç©åˆ°é ‚éƒ¨ï¼‰
            let topFruit = fruits.find(fruit => fruit.y - fruit.radius < 50);
            if (topFruit) {
                endGame();
            }
        }
        
        // ç¹ªè£½éŠæˆ²
        function draw() {
            // æ¸…é™¤ç•«å¸ƒ
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // ç¹ªè£½èƒŒæ™¯
            ctx.fillStyle = 'rgba(20, 20, 35, 0.7)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ç¹ªè£½æ‰è½å€åŸŸæŒ‡ç¤ºç·š
            ctx.strokeStyle = 'rgba(76, 209, 55, 0.5)';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(0, 70);
            ctx.lineTo(canvas.width, 70);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // ç¹ªè£½æ‰€æœ‰æ°´æœ
            fruits.forEach(fruit => {
                drawFruit(fruit);
            });
            
            // ç¹ªè£½ç•¶å‰æ‰è½çš„æ°´æœ
            if (dropFruit) {
                drawFruit(dropFruit);
                
                // ç¹ªè£½é è¦½ç·š
                ctx.strokeStyle = 'rgba(76, 209, 55, 0.3)';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(dropFruit.x, dropFruit.y);
                ctx.lineTo(dropFruit.x, canvas.height);
                ctx.stroke();
            }
            
            // ç¹ªè£½é ‚éƒ¨æ–‡å­—
            ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
            ctx.font = '16px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('é»æ“Šä¸Šæ–¹å€åŸŸè®“æ°´æœæ‰è½', canvas.width / 2, 30);
        }
        
        // ç¹ªè£½å–®å€‹æ°´æœ
        function drawFruit(fruit) {
            // ç¹ªè£½æ°´æœé™°å½±
            ctx.beginPath();
            ctx.arc(fruit.x, fruit.y + 2, fruit.radius, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.fill();
            
            // ç¹ªè£½æ°´æœæœ¬é«”
            ctx.beginPath();
            ctx.arc(fruit.x, fruit.y, fruit.radius, 0, Math.PI * 2);
            ctx.fillStyle = fruit.color;
            ctx.fill();
            
            // ç¹ªè£½æ°´æœé«˜å…‰
            ctx.beginPath();
            ctx.arc(fruit.x - fruit.radius * 0.3, fruit.y - fruit.radius * 0.3, fruit.radius * 0.2, 0, Math.PI * 2);
            ctx.fillStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.fill();
            
            // ç¹ªè£½æ°´æœè¡¨æƒ…
            ctx.font = `${fruit.radius}px Arial`;
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            ctx.fillText(fruit.emoji, fruit.x, fruit.y);
        }
        
        // æ›´æ–°é¡¯ç¤º
        function updateDisplay() {
            document.getElementById('score').textContent = score;
            document.getElementById('level').textContent = level;
        }
        
        // çµæŸéŠæˆ²
        function endGame() {
            gameOver = true;
            gameRunning = false;
            
            document.getElementById('finalScore').textContent = score;
            document.getElementById('gameOver').style.display = "flex";
        }
        
        // çª—å£å¤§å°æ”¹è®Šæ™‚èª¿æ•´ç•«å¸ƒ
        window.addEventListener('resize', function() {
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            draw();
        });
        
        // åˆå§‹åŒ–éŠæˆ²
        window.onload = initGame;
    </script>
</body>
</html>